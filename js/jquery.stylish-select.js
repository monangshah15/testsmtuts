(function(e){e("html").addClass("stylish-select");if(!Array.prototype.indexOf){Array.prototype.indexOf=function(e){if(this===void 0||this===null)throw new TypeError;var t=Object(this);var n=t.length>>>0;if(n===0)return-1;var r=0;if(arguments.length>0){r=Number(arguments[1]);if(r!==r)r=0;else if(r!==0&&r!==1/0&&r!==-(1/0))r=(r>0||-1)*Math.floor(Math.abs(r))}if(r>=n)return-1;var i=r>=0?r:Math.max(n-Math.abs(r),0);for(;i<n;i++){if(i in t&&t[i]===e)return i}return-1}}e.fn.extend({getSetSSValue:function(t){if(t){e(this).val(t).change();return this}else{return e(this).find(":selected").val()}},resetSS:function(){var t=e(this).data("ssOpts");$this=e(this);$this.next().remove();$this.unbind(".sSelect").sSelect(t)}});e.fn.sSelect=function(t){return this.each(function(){function b(){var t=o.offset().top,n=e(window).height(),s=e(window).scrollTop();if(m>parseInt(r.ddMaxHeight)){m=parseInt(r.ddMaxHeight)}t=t-s;if(t+m>=n){a.css({height:m});u.css({top:"24px",height:m});i.onTop=true}else{a.css({height:m});u.css({top:g+"px",height:m});i.onTop=false}}function w(){o.css("position","relative")}function E(){o.css({position:"static"})}function S(e,t){if(e==true){c=l;i.change()}if(t==true){l=c;x(l)}u.hide();E()}function x(e,t){if(e==-1){s.text(r.defaultText);v.removeClass("hiLite")}else{v.removeClass("hiLite").eq(e).addClass("hiLite");var n=v.eq(e).text(),o=v.eq(e).parent().data("key");try{i.val(o)}catch(a){i[0].selectedIndex=e}s.text(n);if(t==true){c=e;i.change()}if(u.is(":visible")){v.eq(e).focus()}}}function T(t){e(t).unbind("keydown.sSelect").bind("keydown.sSelect",function(e){var t=e.which;d=true;switch(t){case 40:case 39:N();return false;break;case 38:case 37:C();return false;break;case 33:case 36:k();return false;break;case 34:case 35:L();return false;break;case 13:case 27:S(true);return false;break}keyPressed=String.fromCharCode(t).toLowerCase();var n=h.indexOf(keyPressed);if(typeof n!="undefined"){++l;l=h.indexOf(keyPressed,l);if(l==-1||l==null||p!=keyPressed){l=h.indexOf(keyPressed)}x(l);p=keyPressed;return false}})}function N(){if(l<y-1){++l;x(l)}}function C(){if(l>0){--l;x(l)}}function k(){l=0;x(l)}function L(){l=y-1;x(l)}if(e(this).data("option_value")){default_text=e(this).data("option_value")}else if(e(this).attr("placeholder")){default_text=e(this).attr("placeholder")}else{default_text="Please Select"}var n={defaultText:default_text,animationSpeed:0,ddMaxHeight:"300",containerClass:""};var r=e.extend(n,t),i=e(this),s=e('<div class="selectedTxt"></div>'),o=e('<div class="newListSelected '+r.containerClass+'"></div>'),u=e('<div class="SSContainerDivWrapper" style="visibility:hidden;"></div>'),a=e('<ul class="newList"></ul>'),f=-1,l=-1,c=-1,h=[],p=false,d=false,v;e(this).data("ssOpts",t);o.insertAfter(i);o.attr("tabindex",i.attr("tabindex")||"0");s.prependTo(o);a.appendTo(o);a.wrap(u);u=a.parent();i.hide();s.data("ssReRender",!s.is(":visible"));if(i.children("optgroup").length==0){i.children().each(function(t){var n=e(this).text();var i=e(this).val();h.push(n.charAt(0).toLowerCase());if(e(this).attr("selected")=="selected"||e(this).attr("selected")==true){r.defaultText=n;l=c=t}a.append(e('<li><a href="JavaScript:void(0);">'+n+"</a></li>").data("key",i))});v=a.children().children()}else{i.children("optgroup").each(function(){var t=e(this).attr("label"),n=e('<li class="newListOptionTitle">'+t+"</li>"),i=e("<ul></ul>");n.appendTo(a);i.appendTo(n);e(this).children().each(function(){++f;var t=e(this).text();var n=e(this).val();h.push(t.charAt(0).toLowerCase());if(e(this).attr("selected")=="selected"||e(this).attr("selected")==true){r.defaultText=t;l=c=f}i.append(e('<li><a href="JavaScript:void(0);">'+t+"</a></li>").data("key",n))})});v=a.find("ul li a")}var m=a.height(),g=o.height(),y=v.length;if(l!=-1){x(l)}else{s.text(r.defaultText)}b();e(window).bind("resize.sSelect scroll.sSelect",b);s.bind("click.sSelect",function(t){t.stopPropagation();if(e(this).data("ssReRender")){m=a.height("").height();u.height("");g=o.height();e(this).data("ssReRender",false);b()}e(".SSContainerDivWrapper").not(e(this).next()).hide().parent().css("position","static").removeClass("newListSelFocus");u.toggle();w();if(l==-1)l=0;v.eq(l).focus()});v.bind("click.sSelect",function(t){var n=e(t.target);l=v.index(n);d=true;x(l,true);S()});v.bind("mouseenter.sSelect",function(t){var n=e(t.target);n.addClass("newListHover")}).bind("mouseleave.sSelect",function(t){var n=e(t.target);n.removeClass("newListHover")});i.bind("change.sSelect",function(t){var n=e(t.target);if(d==true){d=false;return false}var r=n.find(":selected");l=n.find("option").index(r);x(l)});o.bind("click.sSelect",function(e){e.stopPropagation();T(this)});o.bind("focus.sSelect",function(){e(this).addClass("newListSelFocus");T(this)});o.bind("blur.sSelect",function(){e(this).removeClass("newListSelFocus")});e(document).bind("click.sSelect",function(){o.removeClass("newListSelFocus");if(u.is(":visible")){S(false,true)}else{S(false)}});s.bind("mouseenter.sSelect",function(t){var n=e(t.target);n.parent().addClass("newListSelHover")}).bind("mouseleave.sSelect",function(t){var n=e(t.target);n.parent().removeClass("newListSelHover")});u.css({left:"0",display:"none",visibility:"visible"})})}})(jQuery)