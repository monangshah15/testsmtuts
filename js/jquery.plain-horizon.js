(function(e){e.prototype.extend({plain_horizon:function(e){var t={speed:2e3,easing:null,wait:7e3,autostart:true,pauseOnHover:true,enableGallery:true};$.extend(true,t,e||{});return this.each(function(e,n){new $.plain_horizon($(this),t)})}});$.plain_horizon=function(e,t){var n=this;e.addClass("loading");var r={opts:t,playing:false,obj:e,timeout:false,html:{horizon:$("> .horizon",e),wrapper:$("> .horizon > .wrapper",e),list:$("> .horizon > .wrapper > ul",e),nav:$("> .nav",e),signs:$("> .signs",e)}};var i=$("> li:first",r.html.list);r.init_margin=parseFloat(r.html.horizon.css("margin-left").replace("px",""));r.init_slide_width=i.outerWidth();r.init_margin_2=r.init_margin-r.init_slide_width-i.css("margin-right").replace("px","");$("> li",r.html.list).hide();$("> li > a",r.html.nav).show();$("> li > ul > li:first-child > .entry > .hgroup",r.html.list).css("visibility","hidden");$("> li > ul > li:not(:first-child) > a:first-child",r.html.list).append("<span></span>");$.extend(true,n,r);var s=$("> li:last",n.html.list).detach();s.prependTo(n.html.list);var o=$("> li:eq(0)",r.html.list).html();o+=$("> li:eq(1)",r.html.list).html();o+=$("> li:eq(2)",r.html.list).html();n.preloadImgs(o,null,function(){e.removeClass("loading");r.html.signs.show();r.html.nav.show();$("> li",r.html.list).show();n.align(0,0,0);$("> li:eq(0), > li:eq(1), > li:eq(2)",n.html.list).fadeIn(250);if(n.opts.autostart===true)n.start();n.obj.hover(function(){$(this).addClass("hover");if(n.opts.autostart===true&&n.opts.pauseOnHover===true)n.stop()},function(){$(this).removeClass("hover");if(n.opts.autostart===true&&n.opts.pauseOnHover===true)n.start()});$("> li > a",n.html.nav).click(function(e){e.preventDefault();n.stop();if(n.playing===true)return;if($(this).hasClass("next"))n.forward();else n.backward()});n.bind()})};$.plain_horizon.fn=$.plain_horizon.prototype={start:function(){var e=this;var t=function(){$("> li > a.next",e.html.nav).click()};if(!e.obj.hasClass("hover")){e.timeout=setTimeout(t,e.opts.wait)}},bind:function(){var e=this;if(e.opts.enableGallery){$("> li:eq(1) > ul > li:not(:first-child) > a:first-child",e.html.list).unbind("click").click(function(t){t.preventDefault();e.featured($(this).parent())})}},stop:function(){clearTimeout(this.timeout)},featured:function(e){var t=this,n=[];var r=$("> li:eq(1) > ul > li:first-child > img:first-child",t.html.list);var i=$("> a:first-child",e);var s=i.attr("href");var o=$("> img",i).attr("src");var u=r.attr("alt");n.push(s,u);var a=$(".hgroup > *:first-child > a",e).attr("href");var f=setTimeout(function(){e.addClass("loading")},200);t.preloadImgs(null,n,function(){clearTimeout(f);e.removeClass("loading");var n=$("> li:eq(1) > ul > li:first-child",t.html.list);t.flipImg(r,500,'<img src="'+s+'" alt="'+o+'" style="display: none;" />');var l=$(".hgroup",n).html();$("> li:eq(1) > ul > li:first-child a.more",t.html.list).attr("href",a);var c=$(".hgroup",e);$(".hgroup",n).html(c.html());$(".hgroup",e).html(l);t.updateSigns($("> li:eq(1)",t.html.signs),$("> .entry",n),100,1,function(){},300);i.attr("href",r.attr("src"));t.flipImg($("> img:first-child",i),500,'<img src="'+u+'" style="display: none;" />')})},flipImg:function(e,t,n){var r=this;e.after(n);e.next().fadeIn(t);e.fadeOut(t,function(){e.remove()})},play:function(e,t,n){var r=this;r.playing=true;var i=function(){r.playing=false;e.call(this);r.bind();if(r.opts.autostart===true)r.start()};var s=3,o=-1;if(n=="backward"){s=0;o=0}var u=$("> li:eq("+s+")",r.html.list).html();r.preloadImgs(u,null,function(){$("> li:eq("+s+")",r.html.list).show().addClass("loaded");r.align(500,o);r.html.horizon.animate({marginLeft:t},r.opts.speed,r.opts.easing,i)})},forward:function(){var e=this;var t=$("> li:first",e.html.list).clone();t.appendTo(e.html.list);e.play(function(){$("> li:first",e.html.list).remove();e.html.horizon.css("margin-left",e.init_margin+"px")},e.init_margin_2,"forward")},backward:function(){var e=this;var t=$("> li:last",e.html.list).clone();t.prependTo(e.html.list);e.html.horizon.css("margin-left",e.init_margin_2+"px");e.play(function(){$("> li:last",e.html.list).remove()},e.init_margin,"backward")},align:function(e,t,n){var r=this;var n=n==undefined?300:n;$("> li",r.html.signs).each(function(i,o){var u=i-t;if(i==0)u=0;r.updateSigns(this,$("> li:eq("+u+") > ul > li:first > .entry",r.html.list),e,u,null,n)})},updateSigns:function(e,t,n,r,i,s){var o=this;$("> div",e).fadeOut(n,function(){var n=$("> .hgroup",t);var r=n.html();var o=parseFloat(n.height());$(e).animate({height:o},s,function(){$("> div",e).html(r).fadeIn(function(){if($.isFunction(i))i.call(this)})})})},img_i:function(){},preloadImgs:function(e,t,n){var r=this;if(t===null){var t=[];$("<div/>").append(e).find("img").each(function(e){t.push($(this).attr("src")+(new Date).getTime())})}var i=t.length;if(i==0)return n.call(this);var s=function(e){if(e==i&&$.isFunction(n)){n.call(this)}};var o=function(e){r.preloadImg(t[e],function(){var t=e+1;s.call(this,t);if(i!=t)o.call(this,t)})};o.call(this,0)},preloadImg:function(e,t){var n=new Image;n.onload=function(){t.call(this);n.onload=function(){}};n.onerror=function(){t.call(this)};n.src=e}};$.plain_horizon.fn.extend=$.plain_horizon.extend=$.extend})(jQuery)